{"version":3,"sources":["StoryScript/Engine/characterService.ts","StoryScript/Engine/dataService.ts","StoryScript/Engine/gameService.ts","StoryScript/Engine/globals.ts","StoryScript/Engine/locationService.ts","StoryScript/Engine/maincontroller.ts","StoryScript/Interfaces/equipmentType.ts","StoryScript/Interfaces/game.ts","StoryScript/app.ts","DangerousCave/character.ts","DangerousCave/game.ts","DangerousCave/levelUpController.ts","DangerousCave/ruleService.ts","DangerousCave/textService.ts","DangerousCave/actions/flee.ts","DangerousCave/actions/heal.ts","DangerousCave/actions/inspect.ts","DangerousCave/actions/open.ts","DangerousCave/actions/openWithKey.ts","DangerousCave/actions/randomEnemy.ts","DangerousCave/actions/search.ts","DangerousCave/actions/unlock.ts","DangerousCave/enemies/giantBat.ts","DangerousCave/enemies/goblin.ts","DangerousCave/enemies/orc.ts","DangerousCave/enemies/troll.ts","DangerousCave/items/HealingPotion.ts","DangerousCave/items/blackKey.ts","DangerousCave/items/dagger.ts","DangerousCave/items/ironHelmet.ts","DangerousCave/items/lantern.ts","DangerousCave/items/leatherArmor.ts","DangerousCave/items/leatherHelmet.ts","DangerousCave/items/smallShield.ts","DangerousCave/items/sword.ts","DangerousCave/locations/arena.ts","DangerousCave/locations/candleLitCave.ts","DangerousCave/locations/centreRoom.ts","DangerousCave/locations/crossRoads.ts","DangerousCave/locations/darkCorridor.ts","DangerousCave/locations/doorOne.ts","DangerousCave/locations/entry.ts","DangerousCave/locations/leftCorridor.ts","DangerousCave/locations/leftRoom.ts","DangerousCave/locations/rightCorridor.ts","DangerousCave/locations/rightRoom.ts","DangerousCave/locations/roomOne.ts","DangerousCave/locations/start.ts","DangerousCave/locations/temp.ts","DangerousCave/locations/westCrossing.ts"],"names":[],"mappings":"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","file":"game.js","sourcesContent":["module StoryScript {\r\n    export interface ICharacterService {\r\n        createCharacter(characterData: any): ICharacter;\r\n    }\r\n}\r\n\r\nmodule StoryScript {\r\n    export class CharacterService implements ng.IServiceProvider, ICharacterService {\r\n        private dataService: IDataService;\r\n        private ruleService: IRuleService;\r\n\r\n        constructor(dataService: IDataService, ruleService: IRuleService) {\r\n            var self = this;\r\n            self.dataService = dataService;\r\n            self.ruleService = ruleService;\r\n        }\r\n\r\n        public $get(dataService: IDataService, ruleService: IRuleService): ICharacterService {\r\n            var self = this;\r\n            self.dataService = dataService;\r\n            self.ruleService = ruleService;\r\n\r\n            return {\r\n                createCharacter: self.createCharacter\r\n            };\r\n        }\r\n\r\n        public createCharacter(characterData: any): ICharacter {\r\n            var self = this;\r\n            var character = self.dataService.load<ICharacter>(StoryScript.DataKeys.CHARACTER);\r\n\r\n            if (isEmpty(character)) {\r\n                character = self.ruleService.createCharacter(characterData);\r\n            }\r\n\r\n            if (isEmpty(character.items)) {\r\n                character.items = [];\r\n            }\r\n\r\n            return character;\r\n        }\r\n    }\r\n\r\n    CharacterService.$inject = ['dataService', 'ruleService'];\r\n}","module StoryScript {\r\n    export interface IDataService {\r\n        getDescription(descriptionName: string);\r\n        save<T>(key: string, value: T): void;\r\n        load<T>(key: string): T;\r\n    }\r\n}\r\n\r\nmodule StoryScript {\r\n    export class DataService implements ng.IServiceProvider, IDataService {\r\n        private $q: ng.IQService;\r\n        private $http: ng.IHttpService;\r\n        private $localStorage: any; // Todo: type;\r\n        private definitions: any;\r\n\r\n        constructor($q: ng.IQService, $http: ng.IHttpService, $localStorage: any, definitions: any) {\r\n            var self = this;\r\n            self.$http = $http;\r\n            self.$q = $q;\r\n            self.$localStorage = $localStorage;\r\n            self.definitions = definitions;\r\n        }\r\n\r\n        public $get($q: ng.IQService, $http: ng.IHttpService, $localStorage: any, definitions: any): IDataService {\r\n            var self = this;\r\n            self.$http = $http;\r\n            self.$q = $q;\r\n            self.$localStorage = $localStorage;\r\n            self.definitions = definitions;\r\n\r\n            return {\r\n                getDescription: self.getDescription,\r\n                save: self.save,\r\n                load: self.load\r\n            };\r\n        }\r\n\r\n        public getDescription(descriptionId: string) {\r\n            var self = this;\r\n            var deferred = self.$q.defer();\r\n            var url = '/locations/' + descriptionId + '.html';\r\n\r\n            self.$http.get(url)\r\n                .success(function (data, status, headers, config) {\r\n                    deferred.resolve(data);\r\n                }).\r\n                error(function (data, status, headers, config) {\r\n                    deferred.reject();\r\n                });\r\n\r\n            return deferred.promise;\r\n        }\r\n\r\n        public save<T>(key: string, value: T): void {\r\n            var self = this;\r\n            var clone = angular.copy(value);\r\n            self.$localStorage[key] = JSON.stringify({ data: clone });\r\n        }\r\n\r\n        public load<T>(key: string): T {\r\n            var self = this;\r\n\r\n            try {\r\n                return JSON.parse(self.$localStorage[key]).data;\r\n            }\r\n            catch (exception) {\r\n                console.log('No data loaded for key ' + key);\r\n            }\r\n        }\r\n    }\r\n\r\n    DataService.$inject = ['$q', '$http', '$localStorage', 'definitions'];\r\n}","module StoryScript {\r\n    export interface IGameService {\r\n        init(): void;\r\n        startNewGame(characterData: any): void;\r\n        reset(): void;\r\n        restart(): void;\r\n        saveGame(): void;\r\n        rollDice(dice: string): number;\r\n        fight(enemy: IEnemy): void;\r\n        scoreChange(change: number): void;\r\n        hitpointsChange(change: number): void;\r\n        changeGameState(state: string): void;\r\n    }\r\n}\r\n\r\nmodule StoryScript {\r\n    export class GameService implements ng.IServiceProvider, IGameService {\r\n        private dataService: IDataService;\r\n        private locationService: ILocationService;\r\n        private characterService: ICharacterService;\r\n        private ruleService: IRuleService;\r\n        private game: IGame;\r\n        private gameNameSpace: string;\r\n        private definitions: any;\r\n\r\n        constructor(dataService: IDataService, locationService: ILocationService, characterService: ICharacterService, ruleService: IRuleService, game: IGame, gameNameSpace: string, definitions: any) {\r\n            var self = this;\r\n            self.dataService = dataService;\r\n            self.locationService = locationService;\r\n            self.characterService = characterService;\r\n            self.ruleService = ruleService;\r\n            self.game = game;\r\n            self.gameNameSpace = gameNameSpace;\r\n            self.definitions = definitions;\r\n        }\r\n\r\n        public $get(dataService: IDataService, locationService: ILocationService, characterService: ICharacterService, ruleService: IRuleService, game: IGame, gameNameSpace: string, definitions: any): IGameService {\r\n            var self = this;\r\n            self.dataService = dataService;\r\n            self.locationService = locationService;\r\n            self.characterService = characterService;\r\n            self.ruleService = ruleService;\r\n            self.game = game;\r\n            self.gameNameSpace = gameNameSpace;\r\n            self.definitions = definitions;\r\n\r\n            return {\r\n                init: self.init,\r\n                startNewGame: self.startNewGame,\r\n                reset: self.reset,\r\n                restart: self.restart,\r\n                saveGame: self.saveGame,\r\n                rollDice: self.rollDice,\r\n                fight: self.fight,\r\n                hitpointsChange: self.hitpointsChange,\r\n                scoreChange: self.scoreChange,\r\n                changeGameState: self.changeGameState\r\n            };\r\n        }\r\n\r\n        init = (): void => {\r\n            var self = this;\r\n            self.game.nameSpace = self.gameNameSpace;\r\n\r\n            self.definitions.locations = window[self.gameNameSpace]['Locations'];\r\n            self.definitions.actions = angular.extend(window[self.gameNameSpace]['Actions'], window['StoryScript']['Actions']);\r\n            self.definitions.enemies = window[self.gameNameSpace]['Enemies'];\r\n            self.definitions.items = window[self.gameNameSpace]['Items'];\r\n\r\n            self.game.definitions = self.definitions;\r\n            self.ruleService.setupGame(self.game);\r\n            self.locationService.init(self.game);\r\n            self.game.highScores = self.dataService.load<ScoreEntry[]>(StoryScript.DataKeys.HIGHSCORES);\r\n            self.game.character = self.dataService.load<ICharacter>(StoryScript.DataKeys.CHARACTER);\r\n\r\n            var locationName = self.dataService.load(StoryScript.DataKeys.LOCATION);\r\n\r\n            if (self.game.character && locationName) {\r\n                var lastLocation = self.game.locations.first(locationName);\r\n                var previousLocationName = self.dataService.load(StoryScript.DataKeys.PREVIOUSLOCATION);\r\n\r\n                if (previousLocationName) {\r\n                    self.game.previousLocation = self.game.locations.first(previousLocationName);\r\n                }\r\n\r\n                self.locationService.changeLocation(lastLocation, self.game);\r\n                self.game.state = 'play';\r\n            }\r\n            else {\r\n                self.game.state = 'createCharacter';\r\n            }\r\n\r\n            self.game.rollDice = self.rollDice;\r\n            self.game.calculateBonus = (person: ICharacter, type: string) => { return self.calculateBonus(self.game, person, type); };\r\n        }\r\n\r\n        reset = () => {\r\n            var self = this;\r\n            self.dataService.save(StoryScript.DataKeys.WORLD, {});\r\n            self.locationService.init(self.game);\r\n            var location = self.dataService.load(StoryScript.DataKeys.LOCATION);\r\n\r\n            if (location) {\r\n                self.locationService.changeLocation(location, self.game);\r\n            }\r\n        }\r\n\r\n        startNewGame = (characterData: any): void => {\r\n            var self = this;\r\n            self.game.character = self.characterService.createCharacter(characterData);\r\n            self.dataService.save(StoryScript.DataKeys.CHARACTER, self.game.character);\r\n            self.ruleService.startGame();\r\n        }\r\n\r\n        restart = (): void => {\r\n            var self = this;\r\n            self.dataService.save(StoryScript.DataKeys.CHARACTER, {});\r\n            self.dataService.save(StoryScript.DataKeys.LOCATION, '');\r\n            self.dataService.save(StoryScript.DataKeys.PREVIOUSLOCATION, '');\r\n            self.dataService.save(StoryScript.DataKeys.WORLD, {});\r\n            self.init();\r\n        }\r\n\r\n        saveGame = (): void => {\r\n            var self = this;\r\n            self.dataService.save(StoryScript.DataKeys.CHARACTER, self.game.character);\r\n            self.locationService.saveWorld(self.game.locations);\r\n        }\r\n\r\n        rollDice = (input: string): number => {\r\n            //'xdy+/-z'\r\n            var positiveModifier = input.indexOf('+') > -1;\r\n            var splitResult = input.split('d');\r\n            var numberOfDice = parseInt(splitResult[0]);\r\n            splitResult = positiveModifier ? splitResult[1].split('+') : splitResult[1].split('-');\r\n            var dieCount = parseInt(splitResult[0]);\r\n            var bonus = parseInt(splitResult[1]);\r\n            bonus = isNaN(bonus) ? 0 : bonus;\r\n            bonus = positiveModifier ? bonus : bonus * -1;\r\n            var result = 0;\r\n\r\n            for (var i = 0; i < numberOfDice; i++) {\r\n                result += Math.floor(Math.random() * dieCount + 1);\r\n            }\r\n\r\n            result += bonus;\r\n            return result;\r\n        }\r\n\r\n        calculateBonus = (game: IGame, person: ICharacter, type: string) => {\r\n            var self = this;\r\n            var bonus = 0;\r\n\r\n            if (game.character == person) {\r\n                for (var n in person.equipment) {\r\n                    var item = <IItem>person.equipment[n];\r\n\r\n                    if (item && item.bonuses && item.bonuses[type]) {\r\n                        bonus += item.bonuses[type];\r\n                    }\r\n                };\r\n            }\r\n            else {\r\n                person.items.forEach(function (item) {\r\n                    if (item && item.bonuses && item.bonuses[type]) {\r\n                        bonus += item.bonuses[type];\r\n                    }\r\n                });\r\n            }\r\n\r\n            return bonus;\r\n        }\r\n\r\n        fight = (enemy: IEnemy) => {\r\n            var self = this;\r\n            self.ruleService.fight(enemy);\r\n        }\r\n\r\n        scoreChange = (change: number): void => {\r\n            var self = this;\r\n\r\n            // Todo: change if xp can be lost.\r\n            if (change > 0) {\r\n                var character = self.game.character;\r\n                character.scoreToNextLevel += change;\r\n                var levelUp = self.ruleService.scoreChange(change);\r\n\r\n                if (levelUp) {\r\n                    character.level += 1;\r\n                    character.scoreToNextLevel = 0;\r\n                    self.game.state = 'levelUp';\r\n                }\r\n            }\r\n        }\r\n\r\n        hitpointsChange = (change: number): void => {\r\n            var self = this;\r\n            self.ruleService.hitpointsChange(change);\r\n\r\n            if (self.game.character.currentHitpoints <= 0) {\r\n                self.game.state = 'gameOver';\r\n            }\r\n        }\r\n\r\n        changeGameState = (state: string) => {\r\n            var self = this;\r\n\r\n            if (state == 'gameOver' || state == 'victory') {\r\n                self.updateHighScore();\r\n                self.dataService.save(StoryScript.DataKeys.HIGHSCORES, self.game.highScores);\r\n            }\r\n        }\r\n\r\n        private updateHighScore(): void {\r\n            var self = this;\r\n\r\n            var scoreEntry = { name: self.game.character.name, score: self.game.character.score };\r\n\r\n            if (!self.game.highScores || !self.game.highScores.length) {\r\n                self.game.highScores = [];\r\n            }\r\n\r\n            var scoreAdded = false;\r\n\r\n            self.game.highScores.forEach((entry) => {\r\n                if (self.game.character.score > entry.score && !scoreAdded) {\r\n                    var index = self.game.highScores.indexOf(entry);\r\n\r\n                    if (self.game.highScores.length >= 5) {\r\n                        self.game.highScores.splice(index, 1, scoreEntry);\r\n                    }\r\n                    else {\r\n                        self.game.highScores.splice(index, 0, scoreEntry);\r\n                    }\r\n\r\n                    scoreAdded = true;\r\n                }\r\n            });\r\n\r\n            if (self.game.highScores.length < 5 && !scoreAdded) {\r\n                self.game.highScores.push(scoreEntry);\r\n            }\r\n\r\n            self.dataService.save(StoryScript.DataKeys.HIGHSCORES, self.game.highScores);\r\n        }\r\n    }\r\n\r\n    GameService.$inject = ['dataService', 'locationService', 'characterService', 'ruleService', 'game', 'gameNameSpace', 'definitions'];\r\n}","module StoryScript {\r\n    // This code has to be outside of the addFunctionExtensions to have the correct function scope for the proxy.\r\n    if ((<any>Function.prototype).proxy === undefined) {\r\n        (<any>Function.prototype).proxy = function (proxyFunction: Function) {\r\n            var self = this;\r\n\r\n            return (function () {\r\n                var func = function () {\r\n                    var args = [].slice.call(arguments);\r\n                    args.splice(0, 0, self);\r\n                    return proxyFunction.apply(this, args);\r\n                };\r\n\r\n                (<any>func).isProxy = true;\r\n\r\n                return func;\r\n            })();\r\n        };\r\n    }\r\n\r\n    export function isEmpty(object: any, property?: string) {\r\n        var objectToCheck = property ? object[property] : object;\r\n        return objectToCheck ? Object.keys(objectToCheck).length === 0 : true;\r\n    }\r\n\r\n    export function addFunctionExtensions() {\r\n        // Need to cast to any for ES5 and lower\r\n        if ((<any>Function.prototype).name === undefined) {\r\n            Object.defineProperty(Function.prototype, 'name', {\r\n                get: function () {\r\n                    return /function ([^(]*)/.exec(this + \"\")[1];\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    export function addArrayExtensions() {\r\n        Object.defineProperty(Array.prototype, 'first', {\r\n            enumerable: false,\r\n            value: function (id: any) {\r\n                if (id) {\r\n                    return find(id, this)[0];\r\n                }\r\n                else {\r\n                    return this[0];\r\n                }\r\n            }\r\n        });\r\n\r\n        Object.defineProperty(Array.prototype, 'all', {\r\n            enumerable: false,\r\n            value: function (id: any) {\r\n                return find(id, this);\r\n            }\r\n        });\r\n\r\n        Object.defineProperty(Array.prototype, 'remove', {\r\n            enumerable: false,\r\n            value: function (item: any) {\r\n                // Need to cast to any for ES5 and lower\r\n                var index = (<any>Array.prototype).findIndex.call(this, function (x) {\r\n                    return x === item || (item.id && x.id && item.id === x.id);\r\n                });\r\n\r\n                if (index != -1) {\r\n                    Array.prototype.splice.call(this, index, 1);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    export function definitionToObject<T>(definition: Function): T {\r\n        var item = <T>definition();\r\n        // todo: type\r\n        // Need to cast to any for ES5 and lower\r\n        (<any>item).id = (<any>definition).name;\r\n        return item;\r\n    }\r\n\r\n    export function convertOjectToArray(item) {\r\n        var isArray = !isEmpty(item);\r\n\r\n        for (var n in item) {\r\n            if (isNaN(parseInt(n))) {\r\n                isArray = false;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (!isArray) {\r\n            return;\r\n        }\r\n\r\n        var newArray = [];\r\n\r\n        for (var n in item) {\r\n            newArray.push(item[n]);\r\n        }\r\n\r\n        return newArray;\r\n    }\r\n\r\n    export class DataKeys {\r\n        static HIGHSCORES: string = 'highScores';\r\n        static CHARACTER: string = 'character';\r\n        static LOCATION: string = 'location';\r\n        static PREVIOUSLOCATION: string = 'previousLocation';\r\n        static WORLD: string = 'world';\r\n    }\r\n\r\n    function find(id: any, array: any[]): any[] {\r\n        if (typeof id === 'function') {\r\n            id = id.name;\r\n        }\r\n\r\n        var callBack = id.callBack ? id.callBack : matchById(id);\r\n        return Array.prototype.filter.call(array, callBack);\r\n    }\r\n\r\n    function matchById(id) {\r\n        return function (x) {\r\n            return x.id === id || (x.target && x.target === id || (typeof x.target === 'function' && x.target.name === id));\r\n        };\r\n    }\r\n}","module StoryScript {\r\n    export interface ILocationService {\r\n        init(game: IGame): void;\r\n        loadWorld(): ICollection<ICompiledLocation>;\r\n        saveWorld(locations: ICollection<ICompiledLocation>): void;\r\n        changeLocation(location: any, game: IGame): void;\r\n    }\r\n}\r\n\r\nmodule StoryScript {\r\n    export class LocationService implements ng.IServiceProvider, ILocationService {\r\n        private dataService: IDataService;\r\n        private ruleService: IRuleService;\r\n        private game: IGame;\r\n        private definitions: any;\r\n        private pristineLocations: ICollection<ICompiledLocation>;\r\n        private functionIdCounter: number = 0;\r\n        private functionList: { [id: number]: Function };\r\n\r\n        constructor(dataService: IDataService, ruleService: IRuleService, game: IGame, definitions: any) {\r\n            var self = this;\r\n            self.dataService = dataService;\r\n            self.ruleService = ruleService;\r\n            self.game = game;\r\n            self.definitions = definitions;\r\n        }\r\n\r\n        public $get(dataService: IDataService, ruleService: IRuleService, game: IGame, definitions: any): ILocationService {\r\n            var self = this;\r\n            self.dataService = dataService;\r\n            self.ruleService = ruleService;\r\n            self.game = game;\r\n            self.definitions = definitions;\r\n\r\n            return {\r\n                loadWorld: self.loadWorld,\r\n                saveWorld: self.saveWorld,\r\n                changeLocation: self.changeLocation,\r\n                init: self.init\r\n            };\r\n        }\r\n\r\n        init = (game: IGame) => {\r\n            var self = this;\r\n            game.changeLocation = (location) => { self.changeLocation.call(self, location, game); };\r\n            game.currentLocation = null;\r\n            game.previousLocation = null;\r\n            self.functionList = {};\r\n            game.locations = self.loadWorld();\r\n        }\r\n\r\n        public loadWorld(): ICollection<ICompiledLocation> {\r\n            var self = this;\r\n            var locations = <ICollection<ICompiledLocation>>self.dataService.load(DataKeys.WORLD);\r\n            self.pristineLocations = self.buildWorld();\r\n\r\n            if (isEmpty(locations)) {\r\n                self.save(self.pristineLocations, self.pristineLocations);\r\n                locations = <ICollection<ICompiledLocation>>self.dataService.load(DataKeys.WORLD);\r\n            }\r\n\r\n            self.restore(locations);\r\n\r\n            // Add a proxy to the destination collection push function, to replace the target function pointer\r\n            // with the target id when adding destinations and enemies at runtime.\r\n            locations.forEach(function (location) {\r\n                location.destinations = location.destinations || [];\r\n                location.destinations.push = (<any>location.destinations.push).proxy(self.addDestination);\r\n                location.enemies = location.enemies || [];\r\n                location.enemies.push = (<any>location.enemies.push).proxy((function (): Function {\r\n                    return function () {\r\n                        var args = [].slice.apply(arguments);\r\n                        args.splice(0, 0, this);\r\n                        self.addEnemy(self, args);\r\n                    }\r\n                })());\r\n                location.combatActions = location.combatActions || [];\r\n            });\r\n\r\n            return locations;\r\n        }\r\n\r\n        public saveWorld(locations: ICollection<ICompiledLocation>) {\r\n            var self = this;\r\n            self.save(locations, self.pristineLocations);\r\n        }\r\n\r\n        private save(values, pristineValues, clone?, save?) {\r\n            var self = this;\r\n\r\n            save = save == undefined ? true : false;\r\n\r\n            if (!clone) {\r\n                clone = [];\r\n            }\r\n\r\n            for (var key in values) {\r\n                if (!values.hasOwnProperty(key)) {\r\n                    continue;\r\n                }\r\n\r\n                var value = values[key];\r\n                var pristineValue = pristineValues && pristineValues.hasOwnProperty(key) ? pristineValues[key] : undefined;\r\n\r\n                if (!value) {\r\n                    return;\r\n                }\r\n                else if (Array.isArray(value)) {\r\n                    clone[key] = [];\r\n                    self.save(value, pristineValue, clone[key], save);\r\n                }\r\n                else if (typeof value === \"object\") {\r\n                    if (Array.isArray(clone)) {\r\n                        clone.push(angular.copy(value));\r\n                    }\r\n                    else {\r\n                        clone[key] = angular.copy(value);\r\n                    }\r\n\r\n                    self.save(value, pristineValue, clone[key], save);\r\n                }\r\n                else if (typeof value == 'function') {\r\n                    if (!value.isProxy) {\r\n                        if (pristineValues && pristineValues[key]) {\r\n                            if (Array.isArray(clone)) {\r\n                                clone.push('_function_' + value.functionId);\r\n                            }\r\n                            else {\r\n                                clone[key] = '_function_' + value.functionId;\r\n                            }\r\n                        }\r\n                        else {\r\n                            clone[key] = value.toString();\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    clone[key] = value;\r\n                }\r\n            }\r\n\r\n            if (save) {\r\n                self.dataService.save(StoryScript.DataKeys.WORLD, clone);\r\n            }\r\n        }\r\n\r\n        private restore(loaded) {\r\n            var self = this;\r\n\r\n            for (var key in loaded) {\r\n                if (!loaded.hasOwnProperty(key)) {\r\n                    continue;\r\n                }\r\n\r\n                var value = loaded[key];\r\n\r\n                if (value == undefined) {\r\n                    return;\r\n                }\r\n                else if (typeof value === \"object\") {\r\n                    self.restore(loaded[key]);\r\n                }\r\n                else if (typeof value === 'string') {\r\n                    if (value.indexOf('_function_') > -1) {\r\n                        loaded[key] = self.functionList[parseInt(value.replace('_function_', ''))];\r\n                    }\r\n                    else if (typeof value === 'string' && value.indexOf('function ') > -1) {\r\n                        // Todo: create a new function instead of using eval.\r\n                        loaded[key] = eval('(' + value + ')');\r\n                    }\r\n                }\r\n            }\r\n\r\n            return loaded;\r\n        }\r\n\r\n        public changeLocation(location: ILocation, game: IGame) {\r\n            var self = this;\r\n\r\n            // If no location is specified, go to the previous location.\r\n            if (!location) {\r\n                var tempLocation = game.currentLocation;\r\n                game.currentLocation = game.previousLocation;\r\n                game.previousLocation = tempLocation;\r\n                // Todo: can this be typed somehow?\r\n                location = <any>game.currentLocation;\r\n            }\r\n            // If currently at a location, make this the previous location.\r\n            else if (game.currentLocation) {\r\n                game.previousLocation = game.currentLocation;\r\n            }\r\n\r\n            // If there is no location, we are starting a new game. Quit for now.\r\n            if (!location) {\r\n                return;\r\n            }\r\n\r\n            var key = typeof location == 'function' ? location.name : location.id ? location.id : location;\r\n            game.currentLocation = game.locations.first(key);\r\n\r\n            // remove the return message from the current location destinations.\r\n            if (game.currentLocation.destinations) {\r\n                game.currentLocation.destinations.forEach(function (destination) {\r\n                    if ((<any>destination).isPreviousLocation) {\r\n                        (<any>destination).isPreviousLocation = false;\r\n                    }\r\n                });\r\n            }\r\n\r\n            // Mark the previous location in the current location's destinations to allow\r\n            // the player to more easily backtrack his last step. Also, check if the user\r\n            // has the key for one or more barriers at this location, and add the key actions\r\n            // if that is the case.\r\n            if (game.currentLocation.destinations) {\r\n                game.currentLocation.destinations.forEach(destination => {\r\n                    if (game.previousLocation && destination.target && (<any>destination.target) == game.previousLocation.id) {\r\n                        (<any>destination).isPreviousLocation = true;\r\n                    }\r\n\r\n                    if (destination.barrier && destination.barrier.key) {\r\n                        key = <IKey>game.character.items.first(destination.barrier.key);\r\n\r\n                        if (key) {\r\n                            // Todo: can this be typed somehow?\r\n                            (<any>destination.barrier.actions).openWithKey = (<any>key).open;\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n\r\n            // Save the previous and current location, then get the location text.\r\n            self.dataService.save(StoryScript.DataKeys.LOCATION, game.currentLocation.id);\r\n\r\n            if (game.previousLocation) {\r\n                self.dataService.save(StoryScript.DataKeys.PREVIOUSLOCATION, game.previousLocation.id);\r\n            }\r\n\r\n            game.currentLocation.items = game.currentLocation.items || [];\r\n            game.currentLocation.enemies = game.currentLocation.enemies || [];\r\n\r\n            self.loadLocationDescriptions(game);\r\n\r\n            self.ruleService.initCombat(game.currentLocation);\r\n            self.ruleService.enterLocation(game.currentLocation);\r\n\r\n            // If the player hasn't been here before, play the location events.\r\n            if (!game.currentLocation.hasVisited) {\r\n                game.currentLocation.hasVisited = true;\r\n                self.playEvents(game);\r\n            }\r\n        }\r\n\r\n        private buildWorld(): ICompiledLocation[] {\r\n            var self = this;\r\n            self.functionIdCounter = 0;\r\n            var locations = self.definitions.locations;\r\n            var compiledLocations = [];\r\n\r\n            for (var n in locations) {\r\n                var definition = locations[n];\r\n                var location = definitionToObject<ICompiledLocation>(definition);\r\n                location.id = definition.name;\r\n\r\n                if (!location.destinations) {\r\n                    console.log('No destinations specified for location ' + location.id);\r\n                }\r\n\r\n                self.setDestinations(location);\r\n                self.buildEnemies(location);\r\n                self.buildItems(location);\r\n                self.getFunctions(location);\r\n                compiledLocations.push(location);\r\n            }\r\n\r\n            return compiledLocations;\r\n        }\r\n\r\n        private setDestinations(location: ICompiledLocation) {\r\n            var self = this;\r\n\r\n            // Replace the function pointers for the destination targets with the function keys.\r\n            // That's all that is needed to navigate, and makes it easy to save these targets.\r\n            // Also set the barrier selected actions to the first one available for each barrier.\r\n            if (location.destinations) {\r\n                location.destinations.forEach(destination => {\r\n                    //if (typeof destination.target == 'function') {\r\n                    destination.target = (<any>destination.target).name;\r\n                    //}\r\n\r\n                    if (destination.barrier) {\r\n                        if (destination.barrier.actions && destination.barrier.actions.length > 0) {\r\n                            destination.barrier.selectedAction = destination.barrier.actions[0];\r\n                            // Todo: type\r\n                            (<any>destination.barrier.selectedAction).value = 0;\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        private buildEnemies(location: ICompiledLocation) {\r\n            var self = this;\r\n\r\n            if (location.enemies) {\r\n                var enemies: IEnemy[] = [];\r\n\r\n                location.enemies.forEach((enDef) => {\r\n                    var enemy = definitionToObject<IEnemy>(<any>enDef);\r\n                    self.buildItems(enemy);\r\n                    enemies.push(enemy);\r\n                });\r\n\r\n                (<any>location).enemies = enemies;\r\n            }\r\n        }\r\n\r\n        private buildItems(entry: any) {\r\n            var self = this;\r\n\r\n            if (entry.items) {\r\n                var items: IItem[] = [];\r\n\r\n                entry.items.forEach((itemDef) => {\r\n                    var item = definitionToObject<IItem>(itemDef);\r\n                    items.push(item);\r\n                });\r\n\r\n                (<any>entry).items = items;\r\n            }\r\n        }\r\n\r\n        private getFunctions(location: any) {\r\n            var self = this;\r\n\r\n            for (var key in location) {\r\n                if (!location.hasOwnProperty(key)) {\r\n                    continue;\r\n                }\r\n\r\n                var value = location[key];\r\n\r\n                if (value == undefined) {\r\n                    return;\r\n                }\r\n                else if (typeof value === \"object\") {\r\n                    self.getFunctions(location[key]);\r\n                }\r\n                else if (typeof value == 'function') {\r\n                    self.functionList[self.functionIdCounter] = value;\r\n                    value.functionId = self.functionIdCounter;\r\n                    self.functionIdCounter++;\r\n                }\r\n            }\r\n        }\r\n\r\n        private addDestination() {\r\n            var self = this;\r\n            var args = [].slice.apply(arguments);\r\n            var originalFunction = args.shift();\r\n\r\n            // Replace the target function pointer with the target id.\r\n            for (var n in args) {\r\n                var param = args[n];\r\n                param.target = param.target.name;\r\n            }\r\n\r\n            originalFunction.apply(this, args);\r\n        }\r\n\r\n        private addEnemy(scope: any, args: any) {\r\n            var array = args[0];\r\n            var originalFunction = args[1];\r\n            var enemy = args[2];\r\n            originalFunction.call(array, enemy);\r\n            scope.ruleService.addEnemyToLocation(scope.game.currentLocation, enemy);\r\n        }\r\n\r\n        private playEvents(game: IGame) {\r\n            var self = this;\r\n\r\n            for (var n in game.currentLocation.events) {\r\n                game.currentLocation.events[n](game);\r\n            }\r\n        }\r\n\r\n        private loadLocationDescriptions(game: IGame) {\r\n            var self = this;\r\n\r\n            if (game.currentLocation.descriptions) {\r\n                return;\r\n            }\r\n\r\n            self.dataService.getDescription(game.currentLocation.id).then(function (descriptions) {\r\n                var parser = new DOMParser();\r\n\r\n                if (descriptions.indexOf('<descriptions>') == -1) {\r\n                    descriptions = '<descriptions>' + descriptions + '</descriptions>';\r\n                }\r\n\r\n                var xmlDoc = parser.parseFromString(descriptions, \"text/xml\");\r\n                var descriptionNodes = xmlDoc.getElementsByTagName(\"description\");\r\n                game.currentLocation.descriptions = {};\r\n\r\n                for (var i = 0; i < descriptionNodes.length; i++) {\r\n                    var node = descriptionNodes[i];\r\n                    var nameAttribute = node.attributes['name'];\r\n                    var name = nameAttribute ? nameAttribute.value : 'default';\r\n\r\n                    if (game.currentLocation.descriptions[name]) {\r\n                        throw new Error('There is already a description with name ' + name + ' for location ' + game.currentLocation.id + '.');\r\n                    }\r\n\r\n                    game.currentLocation.descriptions[name] = node.innerHTML;\r\n                }\r\n\r\n                // A location can specify how to select the proper selection using a descriptor selection function. If it is not specified,\r\n                // use the default description selector function.\r\n                if (game.currentLocation.descriptionSelector) {\r\n                    game.currentLocation.text = game.currentLocation.descriptionSelector();\r\n                }\r\n                else {\r\n                    var descriptionSelector = (<any>game.currentLocation).defaultDescriptionSelector;\r\n                    game.currentLocation.text = descriptionSelector ? descriptionSelector() : game.currentLocation.descriptions['default'];\r\n                }\r\n\r\n                // If the description selector did not return a text, use the default description.\r\n                if (!game.currentLocation.text) {\r\n                    game.currentLocation.text = game.currentLocation.descriptions['default'];\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    LocationService.$inject = ['dataService', 'ruleService', 'game', 'definitions'];\r\n}","module StoryScript {\r\n    export class MainController {\r\n        private $scope: ng.IScope;\r\n        private $window: ng.IWindowService;\r\n        private locationService: ILocationService;\r\n        private ruleService: IRuleService;\r\n        private gameService: IGameService;\r\n        private game: IGame;\r\n\r\n        public createCharacterForm: any;\r\n\r\n        // Todo: can this be done differently?\r\n        public reset(): void { };\r\n\r\n        constructor($scope: ng.IScope, $window: ng.IWindowService, locationService: ILocationService, ruleService: IRuleService, gameService: IGameService, game: IGame) {\r\n            var self = this;\r\n            self.$scope = $scope;\r\n            self.$window = $window;\r\n            self.locationService = locationService;\r\n            self.ruleService = ruleService;\r\n            self.gameService = gameService;\r\n            self.game = game;\r\n            self.init();\r\n        }\r\n\r\n        private init() {\r\n            var self = this;\r\n            self.gameService.init();\r\n            self.createCharacterForm = self.ruleService.getCharacterForm();\r\n            self.reset = () => { self.gameService.reset.call(self.gameService); };\r\n\r\n            // Todo: type\r\n            (<any>self.$scope).game = self.game;\r\n\r\n            // Watch functions.\r\n            self.$scope.$watch('game.character.currentHitpoints', self.watchCharacterHitpoints);\r\n            self.$scope.$watch('game.character.score', self.watchCharacterScore);\r\n            self.$scope.$watch('game.state', self.watchGameState);\r\n        }\r\n\r\n        startNewGame = () => {\r\n            var self = this;\r\n            self.gameService.startNewGame(self.createCharacterForm);\r\n            self.game.state = 'play';\r\n        }\r\n\r\n        restart = () => {\r\n            var self = this;\r\n            self.gameService.restart();\r\n            self.init();\r\n        }\r\n\r\n        getButtonClass = (action) => {\r\n            var type = action.type || 'move';\r\n            var buttonClass = 'btn-';\r\n\r\n            switch (type) {\r\n                case 'move': {\r\n                    buttonClass += 'info'\r\n                } break;\r\n                case 'skill': {\r\n                    buttonClass += 'warning';\r\n                } break;\r\n                case 'fight': {\r\n                    buttonClass += 'danger';\r\n                } break;\r\n            }\r\n\r\n            return buttonClass;\r\n        }\r\n\r\n        enemiesPresent = () => {\r\n            var self = this;\r\n            return self.game.currentLocation.enemies.length;\r\n        }\r\n\r\n        barriersPresent = () => {\r\n            var self = this;\r\n            return self.game.currentLocation.destinations && self.game.currentLocation.destinations.some(function (destination) { return !isEmpty(destination.barrier); });\r\n        }\r\n\r\n        actionsPresent = () => {\r\n            var self = this;\r\n            return !self.enemiesPresent() && !isEmpty(self.game.currentLocation.actions);\r\n        }\r\n\r\n        disableActionButton = (action) => {\r\n            var self = this;\r\n            return typeof action.active === \"function\" ? !action.active(self.game) : action.active == undefined ? false : !action.active;\r\n        }\r\n\r\n        public executeAction(action) {\r\n            var self = this;\r\n\r\n            if (action && typeof action === 'function') {\r\n                // Modify the arguments collection to add the game to the collection before\r\n                // calling the function specified.\r\n                var args = [].slice.call(arguments);\r\n                args.shift();\r\n                args.splice(0, 0, self.game);\r\n                action.apply(this, args);\r\n\r\n                // After each action, save the game.\r\n                self.gameService.saveGame();\r\n            }\r\n        }\r\n\r\n        executeBarrierAction = (destination, barrier) => {\r\n            var self = this;\r\n\r\n            // Get the selected action manually because ng-options does not work and I have to use ng-repeat\r\n            // which does not supply a full object.\r\n            var action = barrier.actions[barrier.selectedAction];\r\n            var args = [action.action, destination, barrier, action];\r\n            self.executeAction.apply(this, args);\r\n        }\r\n\r\n        changeLocation = (location: string) => {\r\n            var self = this;\r\n\r\n            // Call changeLocation without using the execute action as the game parameter is not needed.\r\n            self.game.changeLocation(location);\r\n            self.gameService.saveGame();\r\n        }\r\n\r\n        pickupItem = (item: IItem): void => {\r\n            var self = this;\r\n            self.game.character.items.push(item);\r\n            self.game.currentLocation.items.remove(item);\r\n        }\r\n\r\n        dropItem = (item: IItem): void => {\r\n            var self = this;\r\n            self.game.character.items.remove(item);\r\n            self.game.currentLocation.items.push(item);\r\n        }\r\n\r\n        equipItem = (item: IItem) => {\r\n            var self = this;\r\n\r\n            var equippedItem = self.game.character.equipment[StoryScript.EquipmentType[item.equipmentType]];\r\n\r\n            if (equippedItem) {\r\n                self.game.character.items.push(equippedItem);\r\n            }\r\n\r\n            self.game.character.equipment[StoryScript.EquipmentType[item.equipmentType]] = item;\r\n            self.game.character.items.remove(item);\r\n        }\r\n\r\n        fight = (game: IGame, enemy: IEnemy) => {\r\n            var self = this;\r\n            self.gameService.fight(enemy);\r\n        }\r\n\r\n        private watchCharacterHitpoints(newValue, oldValue, scope) {\r\n            if (parseInt(newValue) && parseInt(oldValue) && newValue != oldValue) {\r\n                var change = newValue - oldValue;\r\n                scope.controller.gameService.hitpointsChange(change);\r\n            }\r\n        }\r\n\r\n        private watchCharacterScore(newValue, oldValue, scope) {\r\n            if (parseInt(newValue) && parseInt(oldValue) && newValue != oldValue) {\r\n                var increase = newValue - oldValue;\r\n                scope.controller.gameService.scoreChange(increase);\r\n            }\r\n        }\r\n\r\n        private watchGameState(newValue, oldValue, scope) {\r\n            if (newValue != undefined) {\r\n                scope.controller.gameService.changeGameState(newValue);\r\n            }\r\n        }\r\n    }\r\n\r\n    MainController.$inject = ['$scope', '$window', 'locationService', 'ruleService', 'gameService', 'game'];\r\n}","module StoryScript {\r\n    export enum EquipmentType {\r\n        Head,\r\n        Amulet,\r\n        Hands,\r\n        LeftHand,\r\n        LeftRing,\r\n        RightHand,\r\n        RightRing,\r\n        Body,\r\n        Legs,\r\n        Feet,\r\n        Miscellaneous\r\n    }\r\n}","module StoryScript {\r\n    export class ScoreEntry {\r\n        name: string;\r\n        score: number;\r\n    }\r\n\r\n    export interface IGame {\r\n        nameSpace: string;\r\n        definitions: any;\r\n        //definitions: {\r\n        //    locations: [() => StoryScript.ILocation],\r\n        //    actions: [() => StoryScript.IAction],\r\n        //    enemies: [() => StoryScript.IEnemy],\r\n        //    Items: [() => StoryScript.IItem]\r\n        //};\r\n        character: ICharacter;\r\n        locations: ICollection<ICompiledLocation>;\r\n        currentLocation: ICompiledLocation;\r\n        previousLocation: ICompiledLocation;\r\n\r\n        highScores: ScoreEntry[];\r\n        actionLog: string[];\r\n        state: string;\r\n\r\n        changeLocation(location: any): void;\r\n        rollDice(dice: string): number;\r\n        calculateBonus(person: ICharacter, type: string): number;\r\n        logToLocationLog(message: string): void;\r\n        logToActionLog(message: string): void;\r\n    }\r\n}","module StoryScript {\r\n    addFunctionExtensions();\r\n    addArrayExtensions();\r\n\r\n    var storyScriptModule = angular.module(\"storyscript\", ['ngSanitize', 'ngStorage']);\r\n\r\n    var game = {};\r\n    storyScriptModule.value('game', game);\r\n    var definitions = {};\r\n    storyScriptModule.value('definitions', definitions);\r\n\r\n    storyScriptModule.service(\"dataService\", DataService);\r\n    storyScriptModule.service(\"locationService\", LocationService);\r\n    storyScriptModule.service(\"characterService\", CharacterService);\r\n    storyScriptModule.service(\"gameService\", GameService);\r\n\r\n    storyScriptModule.controller(\"MainController\", MainController);\r\n}","module DangerousCave {\r\n    export class Character implements StoryScript.ICharacter {\r\n        name: string;\r\n        hitpoints: number = 120;\r\n        currentHitpoints: number = 120;\r\n        score: number;\r\n        scoreToNextLevel: number = 0;\r\n        level: number = 1;\r\n\r\n        kracht: number = 10;\r\n        vlugheid: number = 1;\r\n        oplettendheid: number = 1;\r\n        defense: number = 1;\r\n\r\n        items: StoryScript.ICollection<StoryScript.IItem> = [];\r\n\r\n        equipment: {\r\n            head: StoryScript.IItem,\r\n            amulet: StoryScript.IItem,\r\n            body: StoryScript.IItem,\r\n            hands: StoryScript.IItem,\r\n            leftHand: StoryScript.IItem,\r\n            leftRing: StoryScript.IItem,\r\n            rightHand: StoryScript.IItem,\r\n            rightRing: StoryScript.IItem,\r\n            legs: StoryScript.IItem,\r\n            feet: StoryScript.IItem\r\n        };\r\n\r\n        constructor() {\r\n            this.equipment = {\r\n                head: null,\r\n                amulet: null,\r\n                body: null,\r\n                hands: null,\r\n                leftHand: null,\r\n                leftRing: null,\r\n                rightHand: null,\r\n                rightRing: null,\r\n                legs: null,\r\n                feet: null\r\n            }\r\n        }\r\n    }\r\n}","module DangerousCave {\r\n    export class Game implements StoryScript.IGame {\r\n        nameSpace: string;\r\n        definitions: any;\r\n        //definitions: {\r\n        //    locations: [() => StoryScript.ILocation],\r\n        //    actions: [() => StoryScript.IAction],\r\n        //    enemies: [() => StoryScript.IEnemy],\r\n        //    Items: [() => StoryScript.IItem]\r\n        //};\r\n        character: Character;\r\n        locations: StoryScript.ICollection<StoryScript.ICompiledLocation>;\r\n        currentLocation: StoryScript.ICompiledLocation;\r\n        previousLocation: StoryScript.ICompiledLocation;\r\n        highScores: StoryScript.ScoreEntry[];\r\n        actionLog: string[];\r\n        state: string;\r\n\r\n        // Todo: only to overwrite. Use interface? Better typing?\r\n        changeLocation(location: any) { }\r\n        rollDice(dice: string): number { return 0; }\r\n        calculateBonus(person, type: string): number { return 0; }\r\n        logToLocationLog = (message: string) => { }\r\n        logToActionLog = (message: string) => { }\r\n    }\r\n\r\n    var storyScriptModule = angular.module(\"storyscript\");\r\n    storyScriptModule.value(\"gameNameSpace\", 'DangerousCave');\r\n}","module DangerousCave {\r\n    export class LevelUpController {\r\n        private $scope: ng.IScope;\r\n        private ruleService: RuleService;\r\n        private game: Game;\r\n\r\n        public selectedReward: {\r\n            name: string,\r\n            value: string\r\n        }\r\n\r\n        // Todo: type\r\n        public rewards: any;\r\n\r\n        constructor($scope: ng.IScope, ruleService: RuleService, game: Game) {\r\n            var self = this;\r\n            self.$scope = $scope;\r\n            self.ruleService = ruleService;\r\n            self.game = game;\r\n            self.init();\r\n        }\r\n\r\n        private init() {\r\n            var self = this;\r\n            self.rewards = [\r\n                {\r\n                    name: 'kracht',\r\n                    value: 'Kracht'\r\n                },\r\n                {\r\n                    name: 'vlugheid',\r\n                    value: 'Vlugheid'\r\n                },\r\n                {\r\n                    name: 'oplettendheid',\r\n                    value: 'Oplettendheid'\r\n                },\r\n                {\r\n                    name: 'gezondheid',\r\n                    value: 'Gezondheid'\r\n                }\r\n            ];\r\n\r\n            // Todo: type\r\n            self.selectedReward = <any>{};\r\n        }\r\n\r\n        claimReward = () => {\r\n            var self = this;\r\n            self.ruleService.levelUp(self.selectedReward.name);\r\n        }\r\n    }\r\n\r\n    LevelUpController.$inject = ['$scope', 'ruleService', 'game'];\r\n\r\n    var storyScriptModule = angular.module(\"storyscript\");\r\n    storyScriptModule.controller(\"LevelUpController\", LevelUpController);\r\n}","module DangerousCave {\r\n    export class RuleService implements ng.IServiceProvider, StoryScript.IRuleService {\r\n        private game: Game;\r\n\r\n        constructor(game: Game) {\r\n            var self = this;\r\n            self.game = game;\r\n        }\r\n\r\n        public $get(game: Game): StoryScript.IRuleService {\r\n            var self = this;\r\n            self.game = game;\r\n\r\n            return {\r\n                setupGame: self.setupGame,\r\n                getCharacterForm: self.getCharacterForm,\r\n                createCharacter: self.createCharacter,\r\n                startGame: self.startGame,\r\n                addEnemyToLocation: self.addEnemyToLocation,\r\n                enterLocation: self.enterLocation,\r\n                initCombat: self.initCombat,\r\n                fight: self.fight,\r\n                hitpointsChange: self.hitpointsChange,\r\n                scoreChange: self.scoreChange\r\n            };\r\n        }\r\n\r\n        setupGame = (game: StoryScript.IGame): void => {\r\n            game.highScores = [];\r\n            game.actionLog = [];\r\n\r\n            game.logToLocationLog = (message: string) => {\r\n                game.currentLocation.log = game.currentLocation.log || [];\r\n                game.currentLocation.log.push(message);\r\n            }\r\n\r\n            game.logToActionLog = (message: string) => {\r\n                game.actionLog.splice(0, 0, message);\r\n            }\r\n        }\r\n\r\n        public getCharacterForm() {\r\n            return {\r\n                specialties: [\r\n                    {\r\n                        name: 'sterk',\r\n                        value: 'Sterk'\r\n                    },\r\n                    {\r\n                        name: 'snel',\r\n                        value: 'Snel'\r\n                    },\r\n                    {\r\n                        name: 'slim',\r\n                        value: 'Slim'\r\n                    }\r\n                ],\r\n                items: [\r\n                    Items.Dagger(),\r\n                    Items.LeatherHelmet(),\r\n                    Items.Lantern()\r\n                ]\r\n            };\r\n        }\r\n\r\n        public createCharacter(characterData: any): StoryScript.ICharacter {\r\n            var self = this;\r\n            var character = new Character();\r\n            character.name = characterData.name;\r\n\r\n            switch (characterData.selectedSpecialty.name) {\r\n                case 'sterk': {\r\n                    character.kracht++;\r\n                } break;\r\n                case 'snel': {\r\n                    character.vlugheid++;\r\n                } break;\r\n                case 'slim': {\r\n                    character.oplettendheid++;\r\n                } break;\r\n            }\r\n\r\n            character.items.push(characterData.selectedItem);\r\n            return character;\r\n        }\r\n\r\n        public startGame() {\r\n            var self = this;\r\n            self.game.changeLocation(self.game.locations.first(Locations.Start));\r\n        }\r\n\r\n        public addEnemyToLocation(location: StoryScript.ICompiledLocation, enemy: StoryScript.IEnemy) {\r\n            var self = this;\r\n            self.addFleeAction(location);\r\n        }\r\n\r\n        public enterLocation(location: StoryScript.ICompiledLocation): void {\r\n            var self = this;\r\n\r\n            self.game.logToActionLog('Je komt aan in ' + location.name);\r\n\r\n            if (location.id != 'start' && !location.hasVisited) {\r\n                self.game.character.score += 1;\r\n            }\r\n        }\r\n\r\n        public initCombat(location: StoryScript.ICompiledLocation) {\r\n            var self = this;\r\n\r\n            // Log the presense of enemies to the action log.\r\n            location.enemies.forEach(function (enemy) {\r\n                self.game.logToActionLog('Er is hier een ' + enemy.name);\r\n            });\r\n\r\n            self.addFleeAction(location);\r\n        }\r\n\r\n        levelUp = (reward: string) => {\r\n            var self = this;\r\n\r\n            if (reward != 'gezondheid') {\r\n                self.game.character[reward]++;\r\n            }\r\n            else {\r\n                self.game.character.hitpoints += 10;\r\n                self.game.character.currentHitpoints += 10;\r\n            }\r\n\r\n            self.game.state = 'play';\r\n        }\r\n\r\n        fight = (enemyToFight: StoryScript.IEnemy) => {\r\n            var self = this;\r\n\r\n            // Todo: change when multiple enemies of the same type can be present.\r\n            var enemy = self.game.currentLocation.enemies.first(enemyToFight.id);\r\n            var check = self.game.rollDice(self.game.character.kracht + 'd6');\r\n\r\n            var characterDamage = check + self.game.character.oplettendheid + self.game.calculateBonus(self.game.character, 'attack') - self.game.calculateBonus(enemy, 'defense');\r\n            self.game.logToActionLog('Je doet de ' + enemy.name + ' ' + characterDamage + ' schade!');\r\n\r\n            enemy.hitpoints -= characterDamage;\r\n\r\n            // Todo: move to game service\r\n            if (enemy.hitpoints <= 0) {\r\n                self.game.logToActionLog('Je verslaat de ' + enemy.name + '!');\r\n                self.game.logToLocationLog('Er ligt hier een dode ' + enemy.name + ', door jou verslagen.');\r\n\r\n                if (enemy.items && enemy.items.length) {\r\n                    enemy.items.forEach(function (item) {\r\n                        self.game.currentLocation.items = self.game.currentLocation.items || [];\r\n\r\n                        // Todo: type\r\n                        self.game.currentLocation.items.push(<any>item);\r\n                    });\r\n\r\n                    enemy.items.splice(0, enemy.items.length);\r\n                }\r\n\r\n                if (enemy.reward) {\r\n                    self.game.character.score += enemy.reward;\r\n                }\r\n\r\n                if (enemy.onDefeat) {\r\n                    enemy.onDefeat(self.game);\r\n                }\r\n\r\n                self.game.currentLocation.enemies.remove(enemy);\r\n            }\r\n\r\n            self.game.currentLocation.enemies.forEach(function (enemy) {\r\n                var check = self.game.rollDice(enemy.attack);\r\n                var enemyDamage = Math.max(0, (check - (self.game.character.vlugheid + self.game.calculateBonus(self.game.character, 'defense'))) + self.game.calculateBonus(enemy, 'damage'));\r\n                self.game.logToActionLog('De ' + enemy.name + ' doet ' + enemyDamage + ' schade!');\r\n                self.game.character.currentHitpoints -= enemyDamage;\r\n            });\r\n        }\r\n\r\n        private addFleeAction(location: StoryScript.ICompiledLocation): void {\r\n            var self = this;\r\n            var numberOfEnemies = location.enemies.length;\r\n            var fleeAction = location.combatActions.first(Actions.Flee);\r\n\r\n            if (fleeAction) {\r\n                delete location.combatActions.splice(location.combatActions.indexOf(fleeAction), 1);\r\n            }\r\n\r\n            if (numberOfEnemies > 0 && numberOfEnemies < self.game.character.vlugheid) {\r\n                location.combatActions.push(Actions.Flee(''));\r\n            }\r\n        }\r\n\r\n        hitpointsChange(change: number) {\r\n            var self = this;\r\n\r\n            if (self.game.character.hitpoints < 5) {\r\n                self.game.logToActionLog('Pas op! Je bent zwaar gewond!');\r\n            }\r\n        }\r\n\r\n        scoreChange(change: number): boolean {\r\n            var self = this;\r\n            var character = self.game.character;\r\n            var levelUp = character.level >= 1 && character.scoreToNextLevel >= 2 + (2 * (character.level));\r\n\r\n            self.game.logToActionLog('Je verdient ' + change + ' punt(en)');\r\n\r\n            if (levelUp) {\r\n                self.game.logToActionLog('Je wordt hier beter in! Je bent nu niveau ' + character.level);\r\n            }\r\n\r\n            return levelUp;\r\n        }\r\n    }\r\n\r\n    RuleService.$inject = ['game'];\r\n\r\n    var storyScriptModule = angular.module(\"storyscript\");\r\n    storyScriptModule.service(\"ruleService\", RuleService);\r\n}","module DangerousCave {\r\n    export class TextService implements ng.IServiceProvider, StoryScript.ITextService {\r\n\r\n        public $get(): StoryScript.ITextService {\r\n            var self = this;\r\n\r\n            return {\r\n                createCharacter: self.createCharacter\r\n            };\r\n        }\r\n\r\n        public createCharacter(): StoryScript.ICharacter {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    //TextService.$inject = [];\r\n\r\n    var storyScriptModule = angular.module(\"storyscript\");\r\n    storyScriptModule.service(\"textService\", TextService);\r\n}","module DangerousCave.Actions {\r\n    export function Flee(text: string): StoryScript.IAction {\r\n        return {\r\n            text: text || 'Vluchten!',\r\n            type: 'fight',\r\n            active: function (game) {\r\n                return !game.isEmpty(game.currentLocation, 'enemies');\r\n            },\r\n            execute: function (game) {\r\n                var check = game.rollDice(game.character.vlugheid + 'd6');\r\n                var result = check * game.character.vlugheid;\r\n                var totalHitpoints = 0;\r\n\r\n                game.currentLocation.enemies.forEach(function (enemy) {\r\n                    totalHitpoints += enemy.hitpoints;\r\n                });\r\n\r\n                if (result >= totalHitpoints / 2) {\r\n                    game.changeLocation();\r\n                }\r\n                else {\r\n                    game.logAction('Je ontsnapping mislukt!');\r\n                };\r\n            }\r\n        }\r\n    }\r\n}","module DangerousCave.Actions {\r\n    export function Heal(potency: string): (...params) => void {\r\n        return function (game: Game, item: StoryScript.IItem) {\r\n            var healed = game.rollDice(potency);\r\n            game.character.currentHitpoints += healed;\r\n\r\n            if (item.charges) {\r\n                item.charges--;\r\n            }\r\n\r\n            if (!item.charges) {\r\n                game.character.items.remove(item);\r\n            }\r\n        }\r\n    }\r\n}","module DangerousCave.Actions {\r\n    export function Inspect(text: string) {\r\n        return function (game: Game, destination: StoryScript.IDestination, barrier: StoryScript.IBarrier, action: StoryScript.IBarrierAction): void {\r\n            var index = barrier.actions.indexOf(action);\r\n\r\n            if (index > -1) {\r\n                barrier.actions.splice(index, 1);\r\n                barrier.selectedAction = barrier.actions.first();\r\n            }\r\n\r\n            if (text) {\r\n                game.logToLocationLog(text);\r\n            }\r\n        }\r\n    }\r\n}","module DangerousCave.Actions {\r\n    export function Open(callback: (game: Game, destination: StoryScript.IDestination) => void) {\r\n        return function (game: Game, destination: StoryScript.IDestination) {\r\n            delete destination.barrier;\r\n\r\n            if (callback) {\r\n                callback(game, destination);\r\n            }\r\n        }\r\n    }\r\n}","module DangerousCave.Actions {\r\n    export function OpenWithKey(callBack: (game: Game, destination: StoryScript.IDestination) => void) {\r\n        return function (game: Game, destination: StoryScript.IDestination) {\r\n            // Todo: remove the key used from the character's inventory.\r\n\r\n            delete destination.barrier;\r\n\r\n            if (callBack) {\r\n                callBack(game, destination);\r\n            }\r\n        }\r\n    }\r\n}","module DangerousCave.Actions {\r\n    export function RandomEnemy(game: Game) {\r\n        var enemies = game.definitions.enemies;\r\n        var enemyCount = 0;\r\n\r\n        for (var n in enemies) {\r\n            enemyCount++;\r\n        }\r\n\r\n        var randomEnemy = enemies[game.rollDice('1d' + enemyCount) - 1]();\r\n        game.currentLocation.enemies.push(randomEnemy);\r\n\r\n        return randomEnemy;\r\n    }\r\n}","module DangerousCave {\r\n    export interface SearchSettings {\r\n        text?: string;\r\n        active?: (parameters: any) => boolean;\r\n        difficulty: number;\r\n        success: (game: Game) => void;\r\n        fail: (game: Game) => void;\r\n    }\r\n}\r\n\r\nmodule DangerousCave.Actions {\r\n    export function Search(settings: SearchSettings): StoryScript.IAction {\r\n        var text = settings.text || 'Zoek';\r\n\r\n        return {\r\n            text: text,\r\n            type: 'skill',\r\n            active: settings.active == undefined ? () => { return true; } : settings.active,\r\n            execute: function (game: Game) {\r\n                var check = game.rollDice(game.character.oplettendheid + 'd6');\r\n                var result;\r\n                result = check * game.character.oplettendheid;\r\n\r\n                // Todo: think of something simpler to remove actions.\r\n                var action = game.currentLocation.actions.first({ callBack: (x: StoryScript.IAction) => { return x.text === text; } });\r\n                game.currentLocation.actions.remove(action);\r\n\r\n                if (result >= settings.difficulty) {\r\n                    settings.success(game);\r\n                }\r\n                else {\r\n                    settings.fail(game);\r\n                };\r\n            }\r\n        }\r\n    }\r\n}","module DangerousCave.Actions {\r\n    export function Unlock(settings: any): StoryScript.IAction {\r\n        return {\r\n            text: settings.text || 'Slot openen',\r\n            type: 'skill',\r\n            active: settings.active == undefined ? true : settings.active,\r\n            execute: function (game: Game) {\r\n                var check = game.rollDice(game.character.vlugheid + 'd6');\r\n                var result;\r\n                result = check * game.character.vlugheid;\r\n\r\n                if (result >= settings.difficulty) {\r\n                    settings.success(game);\r\n                }\r\n                else {\r\n                    settings.fail(game);\r\n                    game.logToActionLog('Het lukt niet.');\r\n                };\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n//deze button moet active blijven, behalve bij een critical fail misschien. Dus een extra setting, kan dat? \r\n// Of kunnen we bijvoorbeeld drie pogingen geven voor hij inactive wordt?","module DangerousCave.Enemies {\r\n    export function GiantBat(): StoryScript.IEnemy {\r\n        return {\r\n            name: 'Reuzenvleermuis',\r\n            hitpoints: 7,\r\n            attack: '1d6',\r\n            reward: 1\r\n        }\r\n    }\r\n}","module DangerousCave.Enemies {\r\n    export function Goblin(): StoryScript.IEnemy {\r\n        return {\r\n            name: 'Goblin',\r\n            hitpoints: 6,\r\n            attack: 'd4+3',\r\n            reward: 1,\r\n            items: [\r\n                Items.Dagger\r\n            ]\r\n        }\r\n    }\r\n}","module DangerousCave.Enemies {\r\n    export function Orc(): StoryScript.IEnemy {\r\n        return {\r\n            name: 'Ork',\r\n            hitpoints: 12,\r\n            attack: '2d4+1',\r\n            reward: 1,\r\n            items: [\r\n                Items.IronHelmet\r\n            ]\r\n        }\r\n    }\r\n}","module DangerousCave.Enemies {\r\n    export function Troll(): StoryScript.IEnemy {\r\n        return {\r\n            name: 'Trol',\r\n            hitpoints: 20,\r\n            attack: '2d6',\r\n            reward: 2,\r\n            items: [\r\n                Items.HealingPotion\r\n            ]\r\n        }\r\n    }\r\n}","module DangerousCave.Items {\r\n    export function HealingPotion(): StoryScript.IItem {\r\n        return {\r\n            name: 'Toverdrank',\r\n            equipmentType: StoryScript.EquipmentType.Miscellaneous,\r\n            use: Actions.Heal('1d8')\r\n        }\r\n    }\r\n}","module DangerousCave.Items {\r\n    export function BlackKey(): StoryScript.IKey {\r\n        return {\r\n            name: 'Black key',\r\n            description: 'This black iron key has a gargoyle figurine on it.',\r\n            equipmentType: StoryScript.EquipmentType.Miscellaneous,\r\n            open: {\r\n                text: 'Open de deur met de zwarte sleutel',\r\n                // Todo: does this work? How does the callback get access to the game and destination?\r\n                execute: (parameters) => Actions.OpenWithKey((game: Game, destination: StoryScript.IDestination) => {\r\n                    game.logToLocationLog('Je opent de deur.');\r\n                    destination.text = 'Donkere kamer';\r\n                })\r\n            }\r\n\r\n            //(game: Game): IAction => {\r\n            //return function() {\r\n            //    text: 'Open de deur met de zwarte sleutel',\r\n            //    execute: Actions.OpenWithKey({\r\n            //        success: function (game, destination) {\r\n            //            game.logLocation('Je opent de deur.');\r\n            //            destination.text = 'Donkere kamer';\r\n            //        }\r\n            //    })\r\n            //}\r\n        }\r\n    }\r\n}","module DangerousCave.Items {\r\n    export function Dagger(): StoryScript.IItem {\r\n        return {\r\n            name: 'Dolk',\r\n            damage: '1',\r\n            equipmentType: StoryScript.EquipmentType.LeftHand\r\n        }\r\n    }\r\n}","module DangerousCave.Items {\r\n    export function IronHelmet(): StoryScript.IItem {\r\n        return {\r\n            name: 'Helm van ijzer',\r\n            defense: 2,\r\n            equipmentType: StoryScript.EquipmentType.Head\r\n        }\r\n    }\r\n}","module DangerousCave.Items {\r\n    export function Lantern(): StoryScript.IItem {\r\n        return {\r\n            name: 'Lantaren',\r\n            bonuses: {\r\n                perception: 1\r\n            },\r\n            equipmentType: StoryScript.EquipmentType.LeftHand\r\n        }\r\n    }\r\n}","module DangerousCave.Items {\r\n    export function LeatherArmor(): StoryScript.IItem {\r\n        return {\r\n            name: 'Harnas van leer',\r\n            defense: 2,\r\n            equipmentType: StoryScript.EquipmentType.Body\r\n        }\r\n    }\r\n}","module DangerousCave.Items {\r\n    export function LeatherHelmet(): StoryScript.IItem {\r\n        return {\r\n            name: 'Helm van leer',\r\n            defense: 1,\r\n            equipmentType: StoryScript.EquipmentType.Head\r\n        }\r\n    }\r\n}","module DangerousCave.Items {\r\n    export function SmallShield(): StoryScript.IItem {\r\n        return {\r\n            name: 'Klein schild',\r\n            defense: 2,\r\n            equipmentType: StoryScript.EquipmentType.LeftHand\r\n        }\r\n    }\r\n}","module DangerousCave.Items {\r\n    export function Sword(): StoryScript.IItem {\r\n        return {\r\n            name: 'Zwaard',\r\n            damage: '3',\r\n            equipmentType: StoryScript.EquipmentType.RightHand\r\n        }\r\n    }\r\n}","module DangerousCave.Locations {\r\n    export function Arena(): StoryScript.ILocation {\r\n        return {\r\n                name: 'Een hoek van de grot waar kaarsen branden',\r\n                enemies: [\r\n                    Enemies.Orc\r\n                ],\r\n                destinations: [\r\n                    {\r\n                        text: 'De grote grot in',\r\n                        target: Locations.CandleLitCave\r\n                    }\r\n                ],\r\n                actions: [\r\n                    {\r\n                        text: 'Onderzoek symbool',\r\n                        type: 'skill',\r\n                        execute: function (game: Game) {\r\n                            game.currentLocation.text = game.currentLocation.descriptions['triggered'];\r\n                            var troll = Enemies.Troll();\r\n                            game.currentLocation.enemies.push(troll);\r\n                            troll.onDefeat = onDefeat;\r\n                            game.logToActionLog('Er verschijnt op magische wijze een enorme trol waar het symbool was! Hij valt je aan!');\r\n                        }\r\n                    }\r\n                ]\r\n            }\r\n\r\n        function onDefeat(game: Game) {\r\n            var randomEnemy = Actions.RandomEnemy(game);\r\n            randomEnemy.onDefeat = this.onDefeat;\r\n        }\r\n    }\r\n}","module DangerousCave.Locations {\r\n    export function CandleLitCave(): StoryScript.ILocation {\r\n        return {\r\n            name: 'Een grot met kaarslicht',\r\n            destinations: [\r\n                {\r\n                    text: 'Onderzoek het kaarslicht',\r\n                    target: Locations.Arena\r\n                },\r\n                {\r\n                    text: 'Sluip naar de donkere gang',\r\n                    target: Locations.DarkCorridor\r\n                },\r\n                {\r\n                    text: 'Richting ingang',\r\n                    target: Locations.RightCorridor\r\n                }\r\n            ],\r\n            actions: [\r\n                Actions.Search({\r\n                    difficulty: 12,\r\n                    success: (game) => {\r\n                        game.logToLocationLog('Je voelt dat hier kortgeleden sterke magie gebruikt is. Ook zie je aan sporen op de vloer dat hier vaak orks lopen.')\r\n                    },\r\n                    fail: (game) => {\r\n                        game.logToActionLog('Terwijl je rondzoekt, struikel je over een losse steen en maak je veel herrie. Er komt een ork op af!');\r\n                        game.currentLocation.enemies.push(Enemies.Orc());\r\n                    }\r\n                })\r\n            ]\r\n        }\r\n    }\r\n}","module DangerousCave.Locations {\r\n    export function CentreRoom(): StoryScript.ILocation {\r\n        return {\r\n            name: 'Een opslagkamer',\r\n            destinations: [\r\n                {\r\n                    text: 'De kamer van de ork',\r\n                    target: Locations.RoomOne\r\n                }\r\n            ],\r\n            actions: [\r\n                Actions.Search({\r\n                    difficulty: 9,\r\n                    success: function (game) {\r\n                        game.logToLocationLog('Je vindt een schild!');\r\n                        // Todo: allow pushing definition instead of item.\r\n                        game.character.items.push(Items.SmallShield());\r\n                    },\r\n                    fail: function (game) {\r\n                        game.logToLocationLog('Je vindt niets.');\r\n                    }\r\n                })\r\n            ]\r\n        }\r\n    }\r\n}","module DangerousCave.Locations {\r\n    export function CrossRoads(): StoryScript.ILocation {\r\n        return {\r\n            name: 'Een kruispunt',\r\n            events: [\r\n                (game: Game) => {\r\n                    var orkCorridor = game.locations.first(Locations.DarkCorridor);\r\n                    var orkPresent = !orkCorridor.hasVisited;\r\n\r\n                    if (game.character.oplettendheid > 2 && orkPresent) {\r\n                        game.logToLocationLog('Je hoort vanuit de westelijke gang een snuivende ademhaling.');\r\n                    }\r\n                }\r\n            ],\r\n            destinations: [\r\n                {\r\n                    text: 'Donkere tunnel (oost)',\r\n                    target: Locations.DarkCorridor\r\n                },\r\n                {\r\n                    text: 'Nog niet! Gang (noord)',\r\n                    target: Locations.Temp\r\n                },\r\n                {\r\n                    text: 'Donkere tunnel (west)',\r\n                    target: Locations.WestCrossing\r\n                },\r\n                {\r\n                    text: 'Gang (zuid)',\r\n                    target: Locations.RightCorridor\r\n                }\r\n            ],\r\n        }\r\n    }\r\n}","module DangerousCave.Locations {\r\n    export function DarkCorridor(): StoryScript.ILocation {\r\n        return {\r\n            name: 'Een donkere smalle gang',\r\n            enemies: [\r\n                Enemies.Orc\r\n            ],\r\n            destinations: [\r\n                {\r\n                    text: 'Richting grote grot (oost)',\r\n                    target: Locations.CandleLitCave\r\n                },\r\n                {\r\n                    text: 'Richting kruispunt (west)',\r\n                    target: Locations.CrossRoads\r\n                }\r\n            ],\r\n        }\r\n    }\r\n}","module DangerousCave.Locations {\r\n    export function DoorOne(): StoryScript.ILocation {\r\n        return {\r\n            name: 'Een donkere gang met een deur',\r\n            destinations: [\r\n                {\r\n                    text: 'De kamer in',\r\n                    target: Locations.RoomOne\r\n                },\r\n                {\r\n                    text: 'Donkere gang',\r\n                    target: Locations.LeftCorridor\r\n                }\r\n            ],\r\n            actions: [\r\n                {\r\n                    text: 'Schop tegen de deur',\r\n                    type: 'fight',\r\n                    execute: (game: Game) => {\r\n                        var check = Math.floor(Math.random() * 6 + 1);\r\n                        var result;\r\n                        result = check * game.character.kracht;\r\n\r\n                        if (result > 8) {\r\n                            game.changeLocation(Locations.RoomOne);\r\n                            game.logToLocationLog('Met een enorme klap schop je de deur doormidden. Je hoort een verrast gegrom en ziet een ork opspringen.');\r\n                        }\r\n                        else {\r\n                            game.logToActionLog('Auw je tenen!! De deur is nog heel.');\r\n                        };\r\n                    }\r\n                },\r\n                Actions.Unlock({\r\n                    difficulty: 10,\r\n                    success: function (game: Game) {\r\n                        game.changeLocation(Locations.RoomOne);\r\n                        game.logToLocationLog('Met meegebrachte pinnetjes duw je in het slot op het mechanisme tot je een klik voelt. De deur is open!');\r\n                        game.logToLocationLog('Je duwt de deur open en kijkt naar binnen.');\r\n                    },\r\n                    fail: function (game) {\r\n                    }\r\n                }),\r\n                Actions.Search({\r\n                    difficulty: 10,\r\n                    success: (game) => {\r\n                        game.logToLocationLog('Je tast de deur, vloer en muren af. Hoog aan de rechtermuur vind je aan een haakje een grote sleutel!')\r\n                    },\r\n                    fail: (game) => {\r\n                        game.logToLocationLog('Je tast de deur, vloer en muren af. Stenen, hout en gruis. Je vindt niets nuttigs.');\r\n                    }\r\n                })\r\n            ]\r\n        }\r\n    }\r\n}","module DangerousCave.Locations {\r\n    export function Entry(): StoryScript.ILocation {\r\n        return {\r\n            name: 'De grot',\r\n            // Example\r\n            //descriptionSelector: function() {\r\n            //    return game.currentLocation.descriptions['lantern'];\r\n            //},\r\n            //navigationDisabled: true,\r\n            items: [\r\n                Items.Lantern,\r\n            ],\r\n            events: [\r\n                (game: Game) => {\r\n                    if (game.character.oplettendheid > 1) {\r\n                        game.logToLocationLog('Je ruikt bloed.');\r\n                    }\r\n                }\r\n            ],\r\n            destinations: [\r\n                {\r\n                    text: 'Donkere gang (west)',\r\n                    target: Locations.LeftCorridor\r\n                },\r\n                {\r\n                    text: 'Schemerige gang (oost)',\r\n                    target: Locations.RightCorridor\r\n                }\r\n            ],\r\n            actions: [\r\n                Actions.Search({\r\n                    difficulty: 5,\r\n                    success: (game) => {\r\n                        game.logToLocationLog('Op de muur staat een pijl, getekend met bloed. Hij wijst naar de rechtergang.')\r\n                    },\r\n                    fail: (game) => {\r\n                        game.logToLocationLog('Je vindt alleen stenen en stof.');\r\n                    }\r\n                })\r\n            ]\r\n        };\r\n    }\r\n}","module DangerousCave.Locations {\r\n    export function LeftCorridor(): StoryScript.ILocation {\r\n        return {\r\n            name: 'Een pikdonkere gang',\r\n            events: [\r\n                (game: Game) => {\r\n                    var damage = Math.floor(Math.random() * 6 + 1) - game.character.vlugheid;\r\n                    game.character.currentHitpoints -= Math.max(0, damage);\r\n                    game.logToActionLog('Aah! Je valt plotseling in een diepe kuil en bezeert je. Je krijgt ' + damage + ' schade door het vallen!');\r\n                    game.logToLocationLog('Er is hier een diepe valkuil.')\r\n                }\r\n            ],\r\n            actions: [\r\n                {\r\n                    text: 'Klim uit de kuil',\r\n                    type: 'skill',\r\n                    execute: (game: Game) => {\r\n                        // Todo: skill check\r\n                        //if (false) {\r\n                        //    game.logToActionLog('Het lukt je niet uit de kuil te klimmen.');\r\n                        //    return;\r\n                        //}\r\n\r\n                        game.logToActionLog('Je klimt uit de kuil.');\r\n\r\n                        game.currentLocation.destinations.push(\r\n                            {\r\n                                text: 'Dieper de grot in',\r\n                                target: Locations.DoorOne\r\n                            },\r\n                            {\r\n                                text: 'Richting ingang',\r\n                                target: Locations.Entry\r\n                            }\r\n                        );\r\n\r\n                        // Todo: think of something simpler to remove actions.\r\n                        var action = game.currentLocation.actions.first({ callBack: (x: StoryScript.IAction) => { return x.text === 'Klim uit de kuil'; } });\r\n                        game.currentLocation.actions.remove(action);\r\n                    }\r\n                },\r\n                Actions.Search({\r\n                    text: 'Doorzoek de kuil',\r\n                    difficulty: 9,\r\n                    success: (game) => {\r\n                        game.currentLocation.items.push(Items.LeatherHelmet());\r\n                        game.logToLocationLog('In de kuil voel je botten, spinrag en de resten van kleding. Ook vind je er een nog bruikbare helm!')\r\n                    },\r\n                    fail: (game) => {\r\n                        game.logToLocationLog('In de kuil voel je botten, spinrag en de resten van kleding.');\r\n                    }\r\n                })\r\n            ]\r\n        }\r\n    }\r\n}","module DangerousCave.Locations {\r\n    export function LeftRoom(): StoryScript.ILocation {\r\n        return {\r\n            name: 'De slaapkamer van de orks',\r\n            enemies: [\r\n                Enemies.Orc,\r\n                Enemies.Goblin\r\n            ],\r\n            destinations: [\r\n                {\r\n                    text: 'De kamer van de ork',\r\n                    target: Locations.RoomOne\r\n                }\r\n            ]\r\n        }\r\n    }\r\n}","module DangerousCave.Locations {\r\n    export function RightCorridor(): StoryScript.ILocation {\r\n        return {\r\n            name: 'Een gemetselde gang',\r\n            destinations: [\r\n                {\r\n                    text: 'Naar het kruispunt (noord)',\r\n                    target: Locations.CrossRoads\r\n                },\r\n                {\r\n                    text: 'Door de houten deur (zuid)',\r\n                    target: Locations.RoomOne\r\n                }\r\n            ]\r\n        }\r\n    }\r\n}","module DangerousCave.Locations {\r\n    export function RightRoom(): StoryScript.ILocation {\r\n        return {\r\n            name: 'Een schemerige gang',\r\n            enemies: [\r\n                Enemies.GiantBat\r\n            ],\r\n            destinations: [\r\n                {\r\n                    text: 'Richting het licht',\r\n                    target: Locations.CandleLitCave\r\n                },\r\n                {\r\n                    text: 'Richting ingang',\r\n                    target: Locations.Entry\r\n                }\r\n            ],\r\n            actions: [\r\n                Actions.Search({\r\n                    difficulty: 8,\r\n                    success: function (game) {\r\n                        game.logToLocationLog('Je ruikt de geur van brandende kaarsen.')\r\n                    },\r\n                    fail: function (game) {\r\n                        game.logToLocationLog('Er zijn hier heel veel vleermuizen. En heel veel vleermuispoep.');\r\n                    }\r\n                })\r\n            ]\r\n        }\r\n    }\r\n}","module DangerousCave.Locations {\r\n    export function RoomOne(): StoryScript.ILocation {\r\n        return {\r\n            name: 'De kamer van de ork',\r\n            enemies: [\r\n                Enemies.Orc\r\n            ],\r\n            items: [\r\n                Items.BlackKey\r\n            ],\r\n            destinations: [\r\n                {\r\n                    text: 'Noord',\r\n                    target: Locations.RightCorridor,\r\n                    barrier: {\r\n                        text: 'Houten deur',\r\n                        actions: [\r\n                            {\r\n                                text: 'Onderzoek de deur',\r\n                                action: Actions.Inspect('Een eikenhouten deur met een ijzeren hendel. De deur is niet op slot.')\r\n                            },\r\n                            {\r\n                                text: 'Open de deur',\r\n                                action: Actions.Open((game: Game, destination: StoryScript.IDestination) => {\r\n                                    game.logToLocationLog('Je opent de eikenhouten deur.');\r\n                                    destination.text = 'Gang (noord)';\r\n                                })\r\n                            }\r\n                        ]\r\n                    }\r\n                },\r\n                {\r\n                    text: 'Tweede deur (west)',\r\n                    target: Locations.CentreRoom,\r\n                },\r\n                {\r\n                    text: 'Derde deur (zuid)',\r\n                    target: Locations.LeftRoom\r\n                },\r\n                {\r\n                    text: 'Deuropening (oost); richting ingang',\r\n                    target: Locations.LeftCorridor\r\n                }\r\n            ]\r\n        }\r\n    }\r\n}","module DangerousCave.Locations {\r\n    export function Start(): StoryScript.ILocation {\r\n        return {\r\n            name: 'De ingang van de Gevaarlijke Grot',\r\n            destinations: [\r\n                {\r\n                    text: 'Ga de grot in',\r\n                    target: Locations.Entry,\r\n                }\r\n            ],\r\n            actions: [\r\n                Actions.Search({\r\n                    difficulty: 10,\r\n                    success: function (game) {\r\n                        game.logToLocationLog('Aan de achterkant van het waarschuwingsbord staan enkele runen in de taal van de orken en trollen. Je kan deze taal helaas niet lezen. Het lijkt erop dat er bloed gebruikt is als inkt.')\r\n                    },\r\n                    fail: function (game) {\r\n                        game.logToLocationLog('Je ziet gras, bomen en struiken. Alle plantengroei stopt een paar centimeter buiten de grot. Binnen is het donker.');\r\n                    }\r\n                })\r\n            ]\r\n        }\r\n    }\r\n}","module DangerousCave.Locations {\r\n    export function Temp(): StoryScript.ILocation {\r\n        return {\r\n            name: 'Deze locatie bestaat nog niet',\r\n            destinations: [\r\n                {\r\n                    text: 'Ga terug naar de ingang',\r\n                    target: Locations.Entry,\r\n                }\r\n            ]\r\n        }\r\n    }\r\n}","module DangerousCave.Locations {\r\n    export function WestCrossing(): StoryScript.ILocation {\r\n        return {\r\n            name: 'Een donkere gemetselde gang',\r\n            enemies: [\r\n                Enemies.Goblin\r\n            ],\r\n            destinations: [\r\n                {\r\n                    text: 'Richting kruispunt (oost)',\r\n                    target: Locations.CrossRoads\r\n                },\r\n                {\r\n                    text: 'Deur (west)',\r\n                    target: Locations.Arena,\r\n                    barrier: {\r\n                        text: 'Metalen deur',\r\n                        key: Items.BlackKey,\r\n                        actions: [\r\n                            {\r\n                                text: 'Onderzoek de deur',\r\n                                action: Actions.Inspect('Een deur van een dof grijs metaal, met een rode deurknop. Op de deur staat een grote afbeelding: een rood zwaard. Zodra je het handvat aanraakt, gloeit het zwaard op met een rood licht. De deur is niet op slot.')\r\n                            },\r\n                            {\r\n                                text: 'Open de deur',\r\n                                action: Actions.Open(function (game, destination) {\r\n                                    game.logToLocationLog('Je opent de deur.');\r\n                                    destination.text = 'Donkere kamer';\r\n                                })\r\n                            }\r\n                        ]\r\n                    }\r\n                }\r\n            ]\r\n        }\r\n    }\r\n}"],"sourceRoot":"/source/"}